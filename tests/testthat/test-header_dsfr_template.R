# WARNING - Generated by {fusen} from dev/flat_composants/flat_header.Rmd: do not edit by hand

test_that("header_dsfr_template works", {
  expect_true(inherits(header_dsfr_template, "function"))

  htmlfile <- readLines(
    system.file(
      get_dsfr_version(with_v = TRUE),
      "composant",
      "entete.html",
      package = "shinygouv"
    )
  )

  #' @description Comparer les parametres par rapport a ceux de la version precedente

  purrr::walk(
    c(
      "class",
      "intitule",
      "url",
      "titre",
      "nom_site_service",
      "baseline"
    ),
    function(param) {
      with_moustache <- paste0("\\{\\{", param, "\\}\\}")
      expect_true(
        any(grepl(pattern = with_moustache, htmlfile)),
        label = paste0("sans moustache '", param, "'")
      )
    }
  )


  test_html <- header_dsfr_template(
    class = "class",
    intitule = "Prefet de Bretagne",
    url = "https://www.prefectures-regions.gouv.fr/bretagne",
    titre = "Accueil - Préfecture de Bretagne",
    nom_site_service = "DREAL Bretagne",
    baseline = "description"
  )

  #' @description tester si tous les params sont remplaces
  expect_false(grepl(pattern = "\\{\\{", test_html))


  #' @description Verifie que les parametres ont bien ete remplace par leurs valeurs

  purrr::walk(
    c(
      class = "class",
      intitule = "Prefet de Bretagne",
      url = "https://www.prefectures-regions.gouv.fr/bretagne",
      titre = "Accueil - Préfecture de Bretagne",
      nom_site_service = "DREAL Bretagne",
      baseline = "description"
    ),
    function(param) {
      expect_true(
        any(grepl(pattern = param, test_html)),
        label = paste0("remplacement de '", param, "'")
      )
    }
  )
})
